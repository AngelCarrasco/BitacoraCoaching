{% extends 'core/coach/base.html' %}
{% load static %}
{%block css %}

{%endblock%}
{% block contenido%}

<div class="container">
    <div class="row">
        <div class="col-6">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Crear una nueva sesion</h3>
                </div>
                <form action="" method="POST">
                    {% csrf_token %}
                    <div class="card-body">

                        <!--condicionar fecha de creacion  -->
                        <div class="form-group">
                            <label for="exampleInputEmail1">Fecha y hora Acordada</label>
                            <input class="form-control" type="datetime-local" id="start" name="fecha_acordada" required=""
                                value="2018-07-22" min="2018-01-01" max="2018-12-31">
                        </div>
                        <div class="form-group">
                            <label for="exampleInputEmail1">Descripcion</label>
                            <input class="form-control" type="text" name="descripcion" id="modalidad"
                                placeholder="Modalidad" required="">
                        </div>
                        <div class="form-group">
                            <label for="exampleInputEmail1">Asignacion y acuerdos</label>
                            <input class="form-control" type="text" name="asigyacuerd" id="asigyacuerd" placeholder="Status"
                                required="">
                        </div>
                        <!-- EMPRESA  -->
                        <div class="form-group">
                            <label for="exampleInputFile">Seleciona una empresa</label>
                            <select class="form-control" name="empresa" id="empresa" required=""
                                onchange="sub_procesos()">

                                <option value="">Selecciona</option>
                                {% for i in empresas %}
                                <option value="{{i.0}}">{{i.1}}</option>
                                {% endfor %}

                            </select>
                        </div>
                        <!-- PROCESO  -->
                        <div class="form-group">
                            <!--combobox anidado filtrar empresa y muestre  procesos asociados  -->
                            <label for="exampleInputFile">Seleciona un proceso</label>
                            <select class="form-control" name="proceso" id="proceso" >
                                <option value="">Selecciona</option>

                                
                            </select>
                        </div>
                        <div class="card-footer">
                            <input class="btn btn-primary" type="submit" value="Agregar">


                        </div>
                    </div>
                </form>
                <h3>{{mensaje}}</h3>
            </div>
        </div>
    </div>
</div>

{%endblock%}

{% block js %}
<script>
    function sub_procesos() {
        let id_empresa = document.getElementById("empresa").value;
        /* Aqui se rescata el id del view rut_empresa = request.GET.get('***empresa****')*/
        let url = '/proceso_empresa/?empresa=' + id_empresa;
        fetch(url)
            .then(function (result) {
                return result.text();
            })
            .then(function (result) {
                document.getElementById("proceso").innerHTML = result;
            });
    }
</script>
{% endblock %}